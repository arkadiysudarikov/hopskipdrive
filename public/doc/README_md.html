<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>README - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
  var index_rel_prefix = "./";
</script>

<script src="./js/navigation.js" defer></script>
<script src="./js/search.js" defer></script>
<script src="./js/search_index.js" defer></script>
<script src="./js/searcher.js" defer></script>
<script src="./js/darkfish.js" defer></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">


<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search (/) for a class, method, ..." spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
<div class="nav-section">
  <h3>Table of Contents</h3>



  <ul class="link-list" role="directory">
              <li>
            <details open>
              <summary>      <a href="#label-HopSkipDrive+Drivers+API">HopSkipDrive Drivers API</a>
</summary>
              <ul class="link-list" role="directory">
                          <li>      <a href="#label-Description">Description</a>
          <li>      <a href="#label-Definitions">Definitions</a>
          <li>      <a href="#label-Prompt">Prompt</a>
          <li>      <a href="#label-Specification">Specification</a>
          <li>      <a href="#label-Features">Features</a>
          <li>      <a href="#label-Design+Decisions">Design Decisions</a>
          <li>      <a href="#label-Assumptions">Assumptions</a>
          <li>      <a href="#label-Gems+for+calling+APIs">Gems for calling APIs</a>
          <li>      <a href="#label-Technologies+Used">Technologies Used</a>
          <li>      <a href="#label-Installation">Installation</a>
          <li>      <a href="#label-Documentation">Documentation</a>
          <li>      <a href="#label-APU+Usage">APU Usage</a>
          <li>      <a href="#label-API+Endpoints">API Endpoints</a>
          <li>      <a href="#label-Screenshot">Screenshot</a>
          <li>      <a href="#label-Contributing">Contributing</a>
          <li>      <a href="#label-License">License</a>
          <li>      <a href="#label-Contact">Contact</a>

              </ul>
            </details>
          </li>

  </ul>
</div>


  <div id="project-metadata">
    
<div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
    <li><a href="./Gemfile.html">Gemfile</a>
    <li><a href="./Gemfile_lock.html">Gemfile.lock</a>
    <li><a href="./Procfile.html">Procfile</a>
    <li><a href="./README_md.html">README</a>
    <li><a href="./Rakefile.html">Rakefile</a>
    <li><a href="./config_ru.html">config.ru</a>
    <li><details><summary>config</summary>
    <ul class="link-list">
      <li><a href="./config/credentials_yml_enc.html">credentials.yml.enc</a>
      <li><a href="./config/master_key.html">master.key</a>
    </ul></details>
    <li><details><summary>log</summary>
    <ul class="link-list">
      <li><a href="./log/development_log.html">development.log</a>
      <li><a href="./log/test_log.html">test.log</a>
    </ul></details>
    <li><a href="./public/robots_txt.html">robots</a>
    <li><a href="./swagger/v1/swagger_yaml.html">swagger.yaml</a>
    <li><details><summary>tmp</summary>
    <ul class="link-list">
      <li><a href="./tmp/caching-dev_txt.html">caching-dev</a>
      <li><a href="./tmp/local_secret_txt.html">local_secret</a>
      <li><a href="./tmp/pids/server_pid.html">server.pid</a>
      <li><a href="./tmp/restart_txt.html">restart</a>
    </ul></details>
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page README.md">

<h1 id="label-HopSkipDrive+Drivers+API">HopSkipDrive Drivers API<span><a href="#label-HopSkipDrive+Drivers+API">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p>&lt;img width=“257” alt=“HopSkipDrive” src=“<a href="https://github.com/arkadiysudarikov/hopskipdrive/assets/382532/8f0304d0-23cc-4aea-b3d4-1da00d5e9ebd">github.com/arkadiysudarikov/hopskipdrive/assets/382532/8f0304d0-23cc-4aea-b3d4-1da00d5e9ebd</a>”&gt;</p>

<p>HopSkipDrive API for drivers.</p>

<h2 id="label-Description">Description<span><a href="#label-Description">&para;</a> <a href="#top">&uarr;</a></span></h2>

<pre>Unlike many other rideshares, HopSkipDrive is a scheduled ride service and not an on-demand ride service.
In our app for drivers, we show them a list of upcoming rides and they can pick the ones they want.
Our goal is to show them the best rides for each driver first, so to that end we have an internal scoring system.
In this exercise you will be implementing a slimmed down version of it</pre>

<h2 id="label-Definitions">Definitions<span><a href="#label-Definitions">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>The <strong>driving distance</strong> between two addresses is the distance in miles that it would take to drive a reasonably efficient route between them. It is not the straight line distance. It can be calculated by using a routing service</p>

<p>The <strong>driving duration</strong> between two addresses is the amount of time in hours it would take to drive the driving distance under realistic driving conditions. It can be calculated by using a routing service</p>

<p>The <strong>commute distance</strong> for a ride is the driving distance from the driver’s home address to the start of the ride, in miles</p>

<p>The <strong>commute duration</strong> for a ride is the amount of time it is expected to take to drive the commute distance, in hours.</p>

<p>The <strong>ride distance</strong> for a ride is the driving distance from the start address of the ride to the destination address, in miles</p>

<p>The <strong>ride duration</strong> for a ride is the amount of time it is expected to take to drive the ride distance, in hours</p>

<p>The <strong>ride earnings</strong> is how much the driver earns by driving the ride. It takes into account both the amount of time the ride is expected to take and the distance.</p>

<p>For the purposes of this exercise, it is calculated as: $12 + $1.50 per mile beyond 5 miles + (<strong>ride duration</strong>) * $0.70 per minute beyond 15 minutes</p>

<h2 id="label-Prompt">Prompt<span><a href="#label-Prompt">&para;</a> <a href="#top">&uarr;</a></span></h2>

<pre>The primary goal of this exercise is for you to demonstrate how you think about testing,
readability, and structuring a Rails application. We are also evaluating your ability to
understand and implement requirements.</pre>

<h2 id="label-Specification">Specification<span><a href="#label-Specification">&para;</a> <a href="#top">&uarr;</a></span></h2>
<ul><li>
<p>[x] Create a Rails 7 application, using Ruby 3+</p>
</li><li>
<p>[x] Include the following entities:</p>
</li><li>
<p>[x] <a href="Ride.html"><code>Ride</code></a></p>
<ul><li>
<p>[x] Has an id, a start address and a destination address. You may end up adding additional information</p>
</li></ul>
</li><li>
<p>[x] <a href="Driver.html"><code>Driver</code></a></p>
<ul><li>
<p>[x] Has an id and a home address</p>
</li></ul>
</li><li>
<p>[x] Build a RESTful API endpoint that returns a paginated JSON list of rides in descending score order for a given driver</p>
</li><li>
<p>[x] Please write up API documentation for this endpoint in MarkDown or alternative</p>
</li><li>
<p>[x] Calculate the score of a ride in $ per hour as: (<strong>ride earnings</strong>) / (<strong>commute duration</strong> + <strong>ride duration</strong>). Higher is better</p>
</li><li>
<p>[x] Google Maps is expensive. Consider how you can reduce duplicate API calls</p>
</li><li>
<p>[x] Include RSpec tests</p>
</li></ul>

<h2 id="label-Features">Features<span><a href="#label-Features">&para;</a> <a href="#top">&uarr;</a></span></h2>
<ul><li>
<p>Implements the upcoming rides endpoint to be used by the driver’s app.</p>
</li></ul>

<h2 id="label-Design+Decisions">Design Decisions<span><a href="#label-Design+Decisions">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>For this project I ended up making some design decisions to keep the project on track while developing the application:</p>
<ul><li>
<p>I decided to use UUID for all IDs to increase information security.</p>
</li><li>
<p><a href="Address.html"><code>Address</code></a> table holds addresses for drivers and rides</p>
<ul><li>
<p><a href="Address.html"><code>Address</code></a> is a string that is valid for Google Directions API</p>
<ul><li>
<p>Location ID should be used in production to accurately query the same locations</p>
</li><li>
<p>Google Place ID is an example of an ID that can be used to identify addresses</p>
</li></ul>
</li></ul>
</li></ul>

<p>Similar addresses that share a location ID (potentially stored in a long-lived, distributed Solid Cache) can be used by both <a href="Driver.html"><code>Driver</code></a> and <a href="Ride.html"><code>Ride</code></a> and used in the API call to get commute and ride distance and duration.</p>
<ul><li>
<p>I use the Rails Credentials to keep the Google Directions API Key secure in both development and production.</p>
</li><li>
<p>Because I'm working with two entities, <a href="Driver.html"><code>Driver</code></a> and <a href="Ride.html"><code>Ride</code></a>, I decided to use a module for the methods.</p>
</li><li>
<p>I decided to create a client class to call the Google Directions API.</p>
</li><li>
<p>I decided to use RSwag to provide OpenAPI UI compliance for the endpoint.</p>
</li><li>
<p>I use <a href="Pagy.html"><code>Pagy</code></a> gem for pagination.</p>
</li><li>
<p>It handles pagination via the query parameter and headers.</p>
<ul><li>
<p>I set the default to be 5 items per page.</p>
</li></ul>
</li><li>
<p>I decided to cache the data returned for 5 minutes at a time.</p>
</li><li>
<p>I think the new Solid Cache can a great candidate for storing data returned from the Google API.</p>
<ul><li>
<p>I think cache can be kept warm between the server restarts to continue to provide fast response from the server.</p>
</li></ul>
</li><li>
<p>I considered adding the “pickup time” to the upcoming rides but for demo purposes I decided to leave it out so that rides can be retrieved at any time in the future.</p>
</li></ul>

<h2 id="label-Assumptions">Assumptions<span><a href="#label-Assumptions">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>I tried to make few assumptions but here they are:</p>
<ul><li>
<p><a href="Ride.html"><code>Ride</code></a> start and destination addresses cannot be the same.</p>
</li></ul>

<h2 id="label-Gems+for+calling+APIs">Gems for calling APIs<span><a href="#label-Gems+for+calling+APIs">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Libraries provide benefits such as retries, improved error-handling and backoff and should be used in production environments.</p>

<p>I considered using various libraries but ultimately decided to make a simple call instead for this project.</p>

<h2 id="label-Technologies+Used">Technologies Used<span><a href="#label-Technologies+Used">&para;</a> <a href="#top">&uarr;</a></span></h2>
<ul><li>
<p>Ruby on Rails</p>
</li><li>
<p>PostgreSQL</p>
</li><li>
<p>OpenAPI</p>
</li></ul>

<h2 id="label-Installation">Installation<span><a href="#label-Installation">&para;</a> <a href="#top">&uarr;</a></span></h2>
<ol><li>
<p>Clone the repository: <code>git clone https://github.com/arkadiysudarikov/hopskipdrive.git</code></p>
</li><li>
<p>Install dependencies: <code>bundle install</code></p>
</li><li>
<p>Set up the database: <code>rails db:setup</code></p>
</li><li>
<p>Run Rails Credentials to add <code>google_api_key</code>: <code>rails credentials:edit</code></p>
</li><li>
<p>Run RSpec: <code>rspec</code></p>
</li><li>
<p>Start the server: <code>rails server</code></p>
</li></ol>

<h2 id="label-Documentation">Documentation<span><a href="#label-Documentation">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p><a href="https://hopskipdrive-fa2a8e6ce701.herokuapp.com/coverage/#_AllFiles">Code coverage</a></p>

<p><a href="https://hopskipdrive-fa2a8e6ce701.herokuapp.com/doc/UpcomingRides.html">UpcomingRides</a> (RDoc)</p>

<p><a href="https://hopskipdrive-fa2a8e6ce701.herokuapp.com/doc/GoogleDirectionsApiClient.html">GoogleDirectionsApiClient</a> (RDoc)</p>

<h2 id="label-APU+Usage">APU Usage<span><a href="#label-APU+Usage">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Please refer to the project’s <a href="https://hopskipdrive-fa2a8e6ce701.herokuapp.com/api-docs/index.html">OpenAPI specification</a> for the project.</p>
<ul><li>
<p>I seed the database with a <a href="Driver.html"><code>Driver</code></a> ID <code>e76885d9-dc50-4616-830e-cd24beefd7d9</code> that can be used to try out the endpoint.</p>
</li></ul>

<h2 id="label-API+Endpoints">API Endpoints<span><a href="#label-API+Endpoints">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>I offer both <code>/api/v1/drivers/{driver_id}/upcoming_rides</code> and <code>/api/v1/{driver_id}/upcoming_rides</code> endpoints.</p>

<pre class="ruby">[
  {
    <span class="ruby-value">&quot;id&quot;:</span> <span class="ruby-string">&quot;f6420103-f79e-4b8e-9cd7-c6f0f523948c&quot;</span>,
    <span class="ruby-value">&quot;start_address_id&quot;:</span> <span class="ruby-string">&quot;9b6e17ca-9543-452e-98cd-9423c2c36923&quot;</span>,
    <span class="ruby-value">&quot;destination_address_id&quot;:</span> <span class="ruby-string">&quot;943d2863-d62d-4426-9b62-c8c697fc97e3&quot;</span>,
    <span class="ruby-value">&quot;created_at&quot;:</span> <span class="ruby-string">&quot;2024-02-16T04:33:32.839Z&quot;</span>,
    <span class="ruby-value">&quot;updated_at&quot;:</span> <span class="ruby-string">&quot;2024-02-16T04:33:32.839Z&quot;</span>,
    <span class="ruby-value">&quot;home_address&quot;:</span> {
      <span class="ruby-value">&quot;id&quot;:</span> <span class="ruby-string">&quot;943d2863-d62d-4426-9b62-c8c697fc97e3&quot;</span>,
      <span class="ruby-value">&quot;address&quot;:</span> <span class="ruby-string">&quot;1600 Amphitheatre Pkwy&quot;</span>,
      <span class="ruby-value">&quot;created_at&quot;:</span> <span class="ruby-string">&quot;2024-02-16T04:33:32.790Z&quot;</span>,
      <span class="ruby-value">&quot;updated_at&quot;:</span> <span class="ruby-string">&quot;2024-02-16T04:33:32.790Z&quot;</span>
    },
    <span class="ruby-value">&quot;start_address&quot;:</span> {
      <span class="ruby-value">&quot;id&quot;:</span> <span class="ruby-string">&quot;9b6e17ca-9543-452e-98cd-9423c2c36923&quot;</span>,
      <span class="ruby-value">&quot;address&quot;:</span> <span class="ruby-string">&quot;1588 E Thomspon Blvd&quot;</span>,
      <span class="ruby-value">&quot;created_at&quot;:</span> <span class="ruby-string">&quot;2024-02-16T04:33:32.781Z&quot;</span>,
      <span class="ruby-value">&quot;updated_at&quot;:</span> <span class="ruby-string">&quot;2024-02-16T04:33:32.781Z&quot;</span>
    },
    <span class="ruby-value">&quot;commute_distance&quot;:</span> <span class="ruby-value">319.3271776007556</span>,
    <span class="ruby-value">&quot;commute_duration&quot;:</span> <span class="ruby-value">4.984444444444445</span>,
    <span class="ruby-value">&quot;destination_address&quot;:</span> {
      <span class="ruby-value">&quot;id&quot;:</span> <span class="ruby-string">&quot;943d2863-d62d-4426-9b62-c8c697fc97e3&quot;</span>,
      <span class="ruby-value">&quot;address&quot;:</span> <span class="ruby-string">&quot;1600 Amphitheatre Pkwy&quot;</span>,
      <span class="ruby-value">&quot;created_at&quot;:</span> <span class="ruby-string">&quot;2024-02-16T04:33:32.790Z&quot;</span>,
      <span class="ruby-value">&quot;updated_at&quot;:</span> <span class="ruby-string">&quot;2024-02-16T04:33:32.790Z&quot;</span>
    },
    <span class="ruby-value">&quot;ride_distance&quot;:</span> <span class="ruby-value">319.08670635167215</span>,
    <span class="ruby-value">&quot;ride_duration&quot;:</span> <span class="ruby-value">4.92</span>,
    <span class="ruby-value">&quot;ride_earnings&quot;:</span> <span class="ruby-value">483.13005952750825</span>,
    <span class="ruby-value">&quot;score&quot;:</span> <span class="ruby-value">48.77911752016575</span>
  },
  {
    <span class="ruby-value">&quot;id&quot;:</span> <span class="ruby-string">&quot;4d2a3d65-2477-4c42-904d-fea7c329250d&quot;</span>,
    <span class="ruby-value">&quot;start_address_id&quot;:</span> <span class="ruby-string">&quot;a1f1b68a-9010-4820-a3b5-c8e22c331ad0&quot;</span>,
    <span class="ruby-value">&quot;destination_address_id&quot;:</span> <span class="ruby-string">&quot;943d2863-d62d-4426-9b62-c8c697fc97e3&quot;</span>,
    <span class="ruby-value">&quot;created_at&quot;:</span> <span class="ruby-string">&quot;2024-02-16T04:33:32.853Z&quot;</span>,
    <span class="ruby-value">&quot;updated_at&quot;:</span> <span class="ruby-string">&quot;2024-02-16T04:33:32.853Z&quot;</span>,
    <span class="ruby-value">&quot;home_address&quot;:</span> {
      <span class="ruby-value">&quot;id&quot;:</span> <span class="ruby-string">&quot;943d2863-d62d-4426-9b62-c8c697fc97e3&quot;</span>,
      <span class="ruby-value">&quot;address&quot;:</span> <span class="ruby-string">&quot;1600 Amphitheatre Pkwy&quot;</span>,
      <span class="ruby-value">&quot;created_at&quot;:</span> <span class="ruby-string">&quot;2024-02-16T04:33:32.790Z&quot;</span>,
      <span class="ruby-value">&quot;updated_at&quot;:</span> <span class="ruby-string">&quot;2024-02-16T04:33:32.790Z&quot;</span>
    },
    <span class="ruby-value">&quot;start_address&quot;:</span> {
      <span class="ruby-value">&quot;id&quot;:</span> <span class="ruby-string">&quot;a1f1b68a-9010-4820-a3b5-c8e22c331ad0&quot;</span>,
      <span class="ruby-value">&quot;address&quot;:</span> <span class="ruby-string">&quot;2112 E Thompson Blvd&quot;</span>,
      <span class="ruby-value">&quot;created_at&quot;:</span> <span class="ruby-string">&quot;2024-02-16T04:33:32.794Z&quot;</span>,
      <span class="ruby-value">&quot;updated_at&quot;:</span> <span class="ruby-string">&quot;2024-02-16T04:33:32.794Z&quot;</span>
    },
    <span class="ruby-value">&quot;commute_distance&quot;:</span> <span class="ruby-value">319.79444989871627</span>,
    <span class="ruby-value">&quot;commute_duration&quot;:</span> <span class="ruby-value">4.999722222222222</span>,
    <span class="ruby-value">&quot;destination_address&quot;:</span> {
      <span class="ruby-value">&quot;id&quot;:</span> <span class="ruby-string">&quot;943d2863-d62d-4426-9b62-c8c697fc97e3&quot;</span>,
      <span class="ruby-value">&quot;address&quot;:</span> <span class="ruby-string">&quot;1600 Amphitheatre Pkwy&quot;</span>,
      <span class="ruby-value">&quot;created_at&quot;:</span> <span class="ruby-string">&quot;2024-02-16T04:33:32.790Z&quot;</span>,
      <span class="ruby-value">&quot;updated_at&quot;:</span> <span class="ruby-string">&quot;2024-02-16T04:33:32.790Z&quot;</span>
    },
    <span class="ruby-value">&quot;ride_distance&quot;:</span> <span class="ruby-value">319.55397864963277</span>,
    <span class="ruby-value">&quot;ride_duration&quot;:</span> <span class="ruby-value">4.934722222222222</span>,
    <span class="ruby-value">&quot;ride_earnings&quot;:</span> <span class="ruby-value">483.83096797444915</span>,
    <span class="ruby-value">&quot;score&quot;:</span> <span class="ruby-value">48.70236787574144</span>
  }
]
</pre>

<p><code>ride_distance</code> is in miles. <code>ride_duration</code> is in hours. <code>ride_earnings</code> is in USD. <code>score</code> is in USD/hour.</p>

<h2 id="label-Screenshot">Screenshot<span><a href="#label-Screenshot">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p><img src="https://github.com/arkadiysudarikov/hopskipdrive/assets/382532/d4bc4daa-6f21-4ff9-b1c1-659a9060ca7c"></p>

<p>&lt;img width=“1680” alt=“Screenshot 2024-02-15 at 20 24 48” src=“<a href="https://github.com/arkadiysudarikov/hopskipdrive/assets/382532/492f1e95-c867-4dc1-a274-b1c6b5bd0884">github.com/arkadiysudarikov/hopskipdrive/assets/382532/492f1e95-c867-4dc1-a274-b1c6b5bd0884</a>”&gt;</p>

<h2 id="label-Contributing">Contributing<span><a href="#label-Contributing">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>If you’d like to contribute to this project, please follow these steps:</p>
<ol><li>
<p>Fork the repository</p>
</li><li>
<p>Create a new branch: <code>git checkout -b feature/your-feature</code></p>
</li><li>
<p>Make your changes and commit them: <code>git commit -am &#39;Add some feature&#39;</code></p>
</li><li>
<p>Push to the branch: <code>git push origin feature/your-feature</code></p>
</li><li>
<p>Submit a pull request</p>
</li></ol>

<h2 id="label-License">License<span><a href="#label-License">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>This project is licensed under the MIT License - see the <a href="LICENSE">LICENSE</a> file for details.</p>

<h2 id="label-Contact">Contact<span><a href="#label-Contact">&para;</a> <a href="#top">&uarr;</a></span></h2>
<ul><li>
<p>Arkadiy Sudarikov - <a href="mailto:arkadiy@arkadiy.com">arkadiy@arkadiy.com</a></p>
</li><li>
<p>Project Link: <a href="https://github.com/arkadiysudarikov/hopskipdrive">github.com/arkadiysudarikov/hopskipdrive</a></p>
</li></ul>

</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.6.2.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

